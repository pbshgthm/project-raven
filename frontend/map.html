<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.css' rel='stylesheet' />
    <script src="support.js"></script>
    <script src="data.json"></script>


    <title>Raven Map</title>
    <style>
      .mapbox-logo{
          display: none !important;
      }
    </style>
  </head>
<body>

    <div id='map' style='width: 900px; height: 800px;'></div>

</body>

<script>

      Data.init(raw_data);


      mapboxgl.accessToken = 'pk.eyJ1IjoicGJzaGd0aG0iLCJhIjoiY2poaXl5NGkxMGRnazM2a2R1Z2VoOHFpNSJ9.oBXuyfoi8qB-paCmQpk8pQ';

      var map = new mapboxgl.Map({
          container: 'map',
          style: 'mapbox://styles/mapbox/light-v10',
          center: [78.5075,22.2358],
          zoom: 4,
          maxZoom: 9,
          maxBounds:[[58.76361,5.25842],[98.25138,37.38944]]
      });




    map.on('load', function(){
              map.addSource('heatmap', {
                  "type": "geojson",
                  "data": Data.getPoints('native_vil')
              });

              map.addSource('linemap', {
                  "type": "geojson",
                  'lineMetrics': true,
                  "data": Data.getLines('native_vil','raid_vil')
              });

              ///*
              //heatmap init
              map.addLayer({
                    "id": "heatmap-layer",
                    "type": "heatmap",
                    "source": "heatmap",
                    "paint": {
                        
                        "heatmap-weight": [
                            "interpolate",
                            ["linear"],
                            ["get", "val"],
                            4, 0.4,
                            9, 0.4
                            ],
                        

                        "heatmap-intensity": [
                            "interpolate",
                            ["linear"],
                            ["zoom"],
                            4, 0.3,
                            9, 0.3
                            ],
                        

                        "heatmap-color": [
                              "interpolate",
                              ["linear"],
                              ["heatmap-density"],
                              0, "rgba(0,0,0,0)",
                              0.10, "#C5E1A5",
                              0.20, "#FFCA28",
                              0.30, "#FFA726",
                              0.99, "#FF7043",
                              1, "#ef5350"
                              ],
                          

                        "heatmap-radius": [
                              "interpolate",
                              ["linear"],
                              ["zoom"],
                              4, 10,
                              9, 30
                              ],
              
                        "heatmap-opacity": [
                              "interpolate",
                              ["linear"],
                              ["zoom"],
                              4, 1,
                              9, 1
                              ],
                    }
              }, 'waterway-label');
              //*/


              ///*
              //circle init
              map.addLayer({
                    "id": "circle-layer",
                    "type": "circle",
                    "source": "heatmap",
                    "paint": {
                        

                        "circle-color": '#BF360C',

                        "circle-stroke-color": 'white',
                        
                        "circle-stroke-width": 0,                          

                        "circle-radius": [
                              "interpolate",
                              ["linear"],
                              ["zoom"],
                              4, 0,
                              7, 0,
                              9, 5
                              ],
              
                        "circle-opacity": [
                              "interpolate",
                              ["linear"],
                              ["zoom"],
                              4, 0,
                              7, 0,
                              9, 0.8
                              ],
                    }
              }, 'waterway-label');
              //*/

              /*
              //line init
              map.addLayer({
                    "id": "line-layer",
                    "type": "line",
                    "source": "linemap",
                    "paint": {
                        'line-width': [
                            "interpolate",
                            ["linear"],
                            ["zoom"],
                            4, 1,
                            9, 2
                            ],
                        'line-color': '#FF7043',
                        'line-opacity':0.05,
                        'line-gradient': [
                            'interpolate',
                            ['linear'],
                            ['line-progress'],
                            0, "#FFD54F",
                            1, "#FF7043"
                            ]
                    }
              }, 'waterway-label');
              //*/

    })

</script>
</html>
